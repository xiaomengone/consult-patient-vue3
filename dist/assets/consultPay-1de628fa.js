import{_ as S}from"./avatar-doctor-206a2b5c.js";import{C as T}from"./CpNavBar-0433d01b.js";import{e as B,f as U,g as G}from"./consult-51e17c38.js";import{d as R,I as j,r as u,q,b as i,o as E,c as F,e,f as a,t as x,w as s,g as O,j as k,i as z,p as A,m as H,_ as J}from"./index-917a8082.js";import{i as K}from"./user-e9a35a4c.js";import{a as C}from"./function-call-abbe6575.js";import"./request-9f1dea72.js";import"./function-call-2c0d12ed.js";const v=_=>(A("data-v-33870e41"),_=_(),H(),_),L={key:0,class:"consult-pay-page"},Q={class:"pay-info"},W={class:"tit"},X=v(()=>a("img",{class:"img",src:S},null,-1)),Y=v(()=>a("p",{class:"desc"},[a("span",null,"极速问诊"),a("span",null,"自动分配医生")],-1)),Z=v(()=>a("div",{class:"pay-space"},null,-1)),ee={class:"pay-schema"},te=v(()=>a("span",{class:"text"},"支付协议",-1)),ae={class:"pay-type"},oe={class:"amount"},le={class:"btn"},ne=R({__name:"consultPay",setup(_){const o=j(),c=u(),r=u(),m=u(!1),y=u(!1),p=u(),f=u(!1),b=u(""),I=t=>B({type:o.consult.type,illnessType:o.consult.illnessType}),P=t=>K(t);q(async()=>{var n;const t=await I({type:o.consult.type,illnessType:o.consult.illnessType});c.value=t==null?void 0:t.data,o.setCoupon(t.data.couponId),console.log(1111,t.data);const l=await P((n=o==null?void 0:o.consult)==null?void 0:n.patientId);r.value=l.data,console.log("userRes",l.data)});const $=async()=>{if(!m.value){C({title:"温馨提示",message:"请勾选支付协议"});return}f.value=!0;const t=await U(o.consult);b.value=t.data.id,f.value=!1,o.clearData(),y.value=!0},V=async()=>{if(p.value==null)return C({title:"温馨提示",message:"请选择支付方式"});const t=await G({paymentMethod:p.value,orderId:b.value,payCallback:"http://localhost:5173/room"});window.location.href=t.data.payUrl};return(t,l)=>{const n=i("van-cell"),h=i("van-cell-group"),g=i("van-checkbox"),D=i("van-submit-bar"),w=i("cp-icon"),N=i("van-button"),M=i("van-action-sheet");return c.value&&r.value?(E(),F("div",L,[e(T,{title:"支付"}),a("div",Q,[a("p",W,"图文问诊 "+x(c.value.payment)+" 元",1),X,Y]),e(h,null,{default:s(()=>[e(n,{title:"优惠券",value:`-¥${c.value.couponDeduction}`},null,8,["value"]),e(n,{title:"积分抵扣",value:`-¥${c.value.pointDeduction}`},null,8,["value"]),e(n,{title:"实付款",value:`¥${c.value.actualPayment}`,class:"pay-price"},null,8,["value"])]),_:1}),Z,e(h,null,{default:s(()=>[e(n,{title:"患者信息",value:`${r.value.name} | ${r.value.gender===0?"女":"男"} | ${r.value.age}岁`},null,8,["value"]),e(n,{title:"病情描述",label:O(o).consult.illnessDesc},null,8,["label"])]),_:1}),a("div",ee,[e(g,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=d=>m.value=d)},{default:s(()=>[k("我已同意 "),te]),_:1},8,["modelValue"])]),e(D,{"button-type":"primary",price:c.value.actualPayment*100,"button-text":"立即支付","text-align":"left",onClick:$,loading:f.value},null,8,["price","loading"]),e(M,{show:y.value,"onUpdate:show":l[3]||(l[3]=d=>y.value=d),title:"支付方式"},{default:s(()=>[a("div",ae,[a("p",oe,"￥"+x(c.value.actualPayment.toFixed(2)),1),e(h,null,{default:s(()=>[e(n,{title:"微信支付",onClick:l[1]||(l[1]=d=>p.value=0)},{icon:s(()=>[e(w,{name:"consult-wechat"})]),extra:s(()=>[e(g,{name:"weixin",checked:p.value==0},null,8,["checked"])]),_:1}),e(n,{title:"支付宝支付",onClick:l[2]||(l[2]=d=>p.value=1)},{icon:s(()=>[e(w,{name:"consult-alipay"})]),extra:s(()=>[e(g,{name:"alipay",checked:p.value==1},null,8,["checked"])]),_:1})]),_:1}),a("div",le,[e(N,{type:"primary",onClick:V,round:"",block:""},{default:s(()=>[k("立即支付")]),_:1})])])]),_:1},8,["show"])])):z("",!0)}}});const ve=J(ne,[["__scopeId","data-v-33870e41"]]);export{ve as default};
